(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{75:function(e,t,o){e.exports=o(92)},80:function(e,t,o){},81:function(e,t,o){},92:function(e,t,o){"use strict";o.r(t);var r=o(0),n=o.n(r),a=o(66),c=o.n(a),i=(o(80),o(81),o(71)),s=o(25),u=o(40),d=o.n(u),l=o(47),p=o(45),f=o(9),g=o(2),m=o(44),h=o(97);var v=o(93),b=o(94),y=o(96),A=o(67);function O(e){var t=e.click,o=e.drawFunction,a=void 0===o?function(){}:o,c=e.height,i=void 0===c?500:c,s=e.width,u=void 0===s?500:s,d=e.canvasPixelRatio,l=void 0===d?2:d,p=e.mousedown,f=e.mousemove,m=e.mouseup,h=e.style,v=void 0===h?{}:h,b=e.touchend,y=e.touchmove,A=e.touchstart,O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=Object(r.useRef)(null);return Object(r.useEffect)(function(){var r=o.current,n=r.getContext("2d"),a=requestAnimationFrame(function(){n.clearRect(0,0,r.width,r.height),n.save(),n.scale(t,t),e(n),n.restore()});return function(){return cancelAnimationFrame(a)}},[e]),o}(a,l),N={width:"".concat(u,"px"),height:"".concat(i,"px")};return n.a.createElement("canvas",{width:u*l,height:i*l,style:Object(g.a)({},N,v),ref:O,onTouchStart:A,onTouchMove:y,onTouchEnd:b,onMouseMove:f,onMouseDown:p,onMouseUp:m,onClick:t})}function N(e){var t=e.click,o=e.canvasPixelRatio,r=void 0===o?2:o,a=e.canvasStyle,c=void 0===a?{}:a,i=e.canvasDrawFunction,s=void 0===i?function(){}:i,u=e.eventCanvasDrawFunction,d=e.eventCanvasStyle,l=void 0===d?{position:"absolute",top:0,left:0,opacity:0}:d,p=e.height,f=e.mousemove,m=e.mousedown,h=e.mouseup,v=e.touchend,b=e.touchmove,y=e.touchstart,A=e.width,N=e.wrapperClassName,E=void 0===N?"canvasWrapper":N,w=e.wrapperSizeRef,S=e.wrapperStyle,x=void 0===S?{}:S,P=u?n.a.createElement(O,{canvasPixelRatio:r,width:A,height:p,drawFunction:u,style:Object(g.a)({},c,l),touchstart:y,touchmove:b,touchend:v,mousemove:f,mousedown:m,mouseup:h,click:t}):"",C=u?{pointerEvents:"none"}:{};return n.a.createElement("div",{className:E,ref:w,style:Object(g.a)({position:"absolute",width:"100%",height:"100%"},x)},P,n.a.createElement(O,{canvasPixelRatio:r,width:A,height:p,drawFunction:s,style:Object(g.a)({},c,C)}))}function E(e){var t=e.borderWidth,o=e.opacity,r=e.content,a=e.contentWidth,c=e.left,i=e.font,s=e.padding,u=e.top;return n.a.createElement("div",{className:"tooltipWrapper",style:{position:"absolute",opacity:o,top:"".concat(u,"px"),left:"".concat(c,"px")}},n.a.createElement("span",{className:"tooltipArrow",style:{content:"",position:"absolute",bottom:"100%",left:"50%",borderWidth:"-".concat(t,"px"),borderStyle:"solid",borderColor:"transparent transparent #999 transparent"}}),n.a.createElement("span",{className:"tooltipContent",style:{position:"absolute",padding:"".concat(s,"px"),width:"".concat(a,"px"),top:"100%",left:"50%",marginLeft:"-".concat(a/2,"px"),font:i,color:"#000",backgroundColor:"#fff",border:"2px solid #999",borderRadius:"5px",pointerEvents:"none",opacity:1,zIndex:1}},r))}var w=function(e){var t=e.nodes,o=e.uniqueIdPropName,r=void 0===o?"uniqueId":o,n=e.groupPropName,a=e.groupIndexPropName,c=void 0===a?"groupIndex":a,i=e.groupKeys,s=Array.isArray(i)?i.reduce(function(e,t){return Object(g.a)({},e,Object(f.a)({},t,0))},{}):{},u={},d={},l=Object(b.a)(t,function(e,t,o){var a,i=t[n],l=t[r],p=void 0===l?o:l;s[i]||(s[i]=0);var m=s[i]++,h=function(e){return e<16777215?"rgb(".concat(255&e,",").concat((65280&e)>>8,",").concat((16711680&e)>>16,")"):""}(o+1);return u[h]=t,d[p]=h,e[p]=Object(g.a)({},t,(a={},Object(f.a)(a,r,p),Object(f.a)(a,c,m),Object(f.a)(a,n,i),a)),e},{});return{colorToNode:u,nodes:l,groupCounts:s,groupIndexPropName:c,nodeIdToColor:d}},S=function(e){var t=e.bandPaddingInner,o=void 0===t?.5:t,r=e.bandPaddingOuter,n=void 0===r?.7:r,a=e.isHangingBar,c=void 0===a||a,i=e.groupIndexPropName,s=void 0===i?"groupIndex":i,u=e.groupPropName,d=e.groupKeys,l=e.height,p=e.margin,f=void 0===p?{top:10,right:10,bottom:10,left:10}:p,g=e.nodeCount,h=e.radiusToPaddingRatio,v=void 0===h?.9:h,b=e.width,y=Object(m.a)().domain(d).range([f.left,b-f.right]).paddingInner([o]).paddingOuter([n]),A=function(e){var t=e.bandwidth,o=e.height,r=e.margin,n=e.maxNodesPerBar,a=t*(o-r.top-r.bottom)/n;return.5*Math.sqrt(a)}({bandwidth:y.bandwidth(),height:l,maxNodesPerBar:g,margin:f,width:b}),O=A*v,N=2*A,E=y.step()*y.paddingOuter(),w=Math.ceil(y.bandwidth()/N),S=[l-f.bottom,f.top],x=Object(m.b)().domain([0,l]).range(c?S.reverse():S);return{radiusWithPadding:A,radiusAccessor:function(){return O},xAccessor:function(e){var t=Math.floor(e[s]%w)*N+A-E;return y(e[u])+t},xScale:y,yAccessor:function(e){var t=Math.ceil((e[s]+1)/w);return x(t*N)}}},x=o(95);var P=function(e){var t=e.nodes,o=e.colorAccessor,r=e.radiusAccessor,n=e.strokeColorAccessor,a=void 0===n?function(){return"#aaa"}:n,c=e.strokeWidth,i=void 0===c?"2":c,s=e.strokeLineJoin,u=void 0===s?"round":s,d=e.xAccessor,l=e.yAccessor;return function(e){Object(x.a)(t,function(t){var n=new Path2D(function(e,t,o){var r=e-o+","+t,n="A"+o+","+o+",0,1,1,";return"M"+r+n+(e+o)+","+t+n+r+"Z"}(d(t),l(t),r(t)));i>0&&(e.strokeStyle=a(t),e.lineWidth=i,e.lineJoin=u,e.stroke(n)),e.fillStyle=o(t),e.fill(n)})}},C=function(e){var t=e.colorAccessor,o=e.font,r=void 0===o?"30px Arial":o,n=e.fontSecondary,a=void 0===n?"20px Arial":n,c=e.fontStrokeColor,i=void 0===c?"#aaa":c,s=e.fontStrokeWidth,u=void 0===s?.25:s,d=e.groupCounts,l=e.groupKeys,p=e.labels,f=e.xAccessor,g=e.yAccessor,m=e.numberOffset,h=void 0===m?20:m;return function(e){var o=[],n=0;d&&(o=Object.values(d),n=o.reduce(function(e,t){return e+t},0)),l.length===p.length&&l.forEach(function(c,s){var d=f(c),l=g(c),m=t(c);if(e.font=r,e.fillStyle=m,e.textAlign="center",e.textBaseline="middle",e.fillText(p[s],d,l),e.lineWidth=u,e.strokeStyle=i,e.strokeText(p[s],d,l),o.length===p.length){var v=o[s]/n*100,b=v<1?v.toPrecision(1):Math.round(v),y="".concat(b,"% (").concat(o[s],")");e.font=a,e.fillText(y,d,l+h),e.strokeText(y,d,l+h)}})}},T=function(e,t){switch(t.type){case"SET_TOOLTIP_CONTENT":case"SET_LAYOUT":return Object(g.a)({},e,t.payload);case"START_RENDER":return Object(g.a)({},e,{isRendering:!0});case"FINISH_RENDER":return Object(g.a)({},e,{isRendering:!1});default:throw new Error("Invalid action type in progressReducer")}};function j(e){var t=e.bandPaddingInner,o=void 0===t?.1:t,a=e.bandPaddingOuter,c=void 0===a?.1:a,i=e.className,s=e.circleStrokeColor,u=void 0===s?"#aaa":s,d=e.circleStrokeWidth,l=e.colorAccessor,f=e.fontStrokeColor,g=e.fontStrokeWidth,m=e.groupPropName,h=e.groupKeys,O=e.groupLabels,x=e.isHangingBar,j=void 0===x||x,I=e.labelColorAccessor,k=e.labelFont,R=void 0===k?"bold 1.1rem Arial":k,W=e.labelFontSecondary,_=void 0===W?"0.9rem Arial":W,M=e.nodes,D=e.margin,F=void 0===D?{top:60,right:20,bottom:10,left:20}:D,L=e.radiusToPaddingRatio,K=void 0===L?.8:L,q=e.uniqueIdPropName,B=e.wrapperStyle,J=Object(A.a)(),U=Object(p.a)(J,3),G=U[0],H=U[1],Y=U[2],z=Object(r.useReducer)(T,{isRendering:!1,nodeCount:0,tooltipContent:"",tooltipContentWidth:0,tooltipOffset:[0,0],radiusWithPadding:1,radiusAccessor:function(){return 1},xAccessor:function(){return 0},xScale:function(){return 0},yAccessor:function(){return 0}}),Q=Object(p.a)(z,2),X=Q[0],V=Q[1];Object(r.useEffect)(function(){var e=S({bandPaddingInner:o,bandPaddingOuter:c,isHangingBar:j,groupIndexPropName:oe,groupKeys:h,groupPropName:m,margin:F,nodeCount:M.length,width:H,height:Y,radiusToPaddingRatio:K}),t=e.radiusWithPadding,r=e.radiusAccessor,n=e.xAccessor,a=e.xScale,i=e.yAccessor;V({type:"SET_LAYOUT",payload:{nodeCount:M.length,radiusWithPadding:t,radiusAccessor:r,xAccessor:n,xScale:a,yAccessor:i}})},[H,Y,h,j,X.nodeCount]);var Z=w({groupPropName:m,groupKeys:h,nodes:M,uniqueIdPropName:q}),$=Z.colorToNode,ee=Z.nodes,te=Z.groupCounts,oe=Z.groupIndexPropName,re=Z.nodeIdToColor,ne=P({nodes:ee,colorAccessor:function(e){return re[e[q]]||""},radiusAccessor:function(){return X.radiusWithPadding},strokeColorAccessor:function(e){return re[e[q]]||""},strokeWidth:0,xAccessor:X.xAccessor,yAccessor:X.yAccessor}),ae=P({nodes:ee,colorAccessor:l,radiusAccessor:X.radiusAccessor,strokeColorAccessor:function(){return u},strokeWidth:d,xAccessor:X.xAccessor,yAccessor:X.yAccessor}),ce=C({colorAccessor:I||l,font:R,fontSecondary:_,fontStrokeColor:f,fontStrokeWidth:g,groupCounts:te,groupKeys:h,labels:O,xAccessor:function(e){return X.xScale(e)-X.xScale.step()*X.xScale.paddingOuter()+X.xScale.bandwidth()/2},yAccessor:function(){return F.top/3},numberOffset:F.top/3+5});return n.a.createElement(n.a.Fragment,null,n.a.createElement(N,{canvasPixelRatio:2,canvasDrawFunction:function(e){V({type:"START_RENDER"}),ae(e),ce(e),V({type:"FINISH_RENDER"})},canvasStyle:{background:"transparent"},eventCanvasDrawFunction:ne,height:Y,mousemove:function(e){var t=e,o=t.target.getContext("2d"),r=o.getImageData(2*t.nativeEvent.offsetX,2*t.nativeEvent.offsetY,1,1).data,a=$["rgb(".concat(r[0],",").concat(r[1],",").concat(r[2],")")];if(a){var c=Object(v.a)(a,[oe]),i=Object(b.a)(c,function(e,t,r){o.font=_;var n=o.measureText("".concat(t,": ").concat(r)).width;return n>e?n+6:e},0);V({type:"SET_TOOLTIP_CONTENT",payload:{tooltipContent:Object(y.a)(c,function(e,t){return n.a.createElement("p",{style:{margin:"2px",textAlign:"center"},key:t},t,": ",e)}),tooltipContentWidth:i,tooltipOffset:[t.pageX,t.pageY]}})}else V({type:"SET_TOOLTIP_CONTENT",payload:{tooltipContent:"",tooltipContentWidth:0,tooltipOffset:X.tooltipContent}})},width:H,wrapperClassName:i,wrapperSizeRef:G,wrapperStyle:B}),n.a.createElement(E,{borderWidth:X.radiusWithPadding,content:X.tooltipContent,opacity:""===X.tooltipContent?0:.85,contentWidth:X.tooltipContentWidth,left:X.tooltipOffset[0],font:_,padding:3,top:X.tooltipOffset[1]}))}var I=o(74),k=function(){var e=Object(l.a)(d.a.mark(function e(t){var o,r,n,a,c,i,s,u,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.metadataCsv,r=void 0===o?"group_id,label,sort_order,color\nD,DONE,7,#2ECC71\nE,RECOVERABLE,5,#F1948A\nF,FATAL,6,#E74C3C\nG,REGISTERED,1,#D6EAF8\nI,INSTANTIATED,3,#5DADE2\nQ,QUEUED,2,#3498DB\nR,RUNNING,4,#ebd857":o,n=t.nNodes,a=void 0===n?2e4:n,c=t.groupPropName,i=void 0===c?"group_id":c,e.next=3,Object(I.a)(r);case 3:return s=e.sent,u=Array.isArray(s)?s.sort(function(e,t){return e.sort_order-t.sort_order}):[],l=new Array(a).fill({}).map(function(e,t){var o;return o={unique_id:"id_".concat(t+1)},Object(f.a)(o,i,u[0][i]),Object(f.a)(o,"some_other_prop","with a very long name"),o}),e.abrupt("return",{nodes:l,groupMetadataArray:u});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),R=function(e,t,o){var r=Math.floor(50*Math.random()),n=new Array(r).fill(0).map(function(){return Math.floor(Math.random()*e.length)});return e.map(function(e,r){if(n.includes(r)){var a=t.findIndex(function(t){return t===e[o]}),c=a;if("E"===t[a])c=1;else if("F"===t[a])c=a;else if("R"===t[a]){var i=Math.random()<=.05?a+2:a+1;c=Math.random()<=.1?i:t.length-1}else c=a<t.length-2?a+1:t.length-1;return Object(g.a)({},e,Object(f.a)({},o,t[c]))}return Object(g.a)({},e)})},W=function(e,t){switch(t.type){case"SET_NODES":return Object(g.a)({},e,{nodes:t.payload});case"SET_GROUP_METADATA":var o=t.payload,r=o.colorPropName,n=o.groupMetadataArray,a=o.groupPropName,c=o.labelPropName,i=n.reduce(function(e,t){return Object(g.a)({},e,Object(f.a)({},t[a],t))},{}),s=n.map(function(e){return e[r]}),u=n.map(function(e){return e[a]}),d=n.map(function(e){return e[c]}),l=Object(m.c)().domain(u).range(s);return Object(g.a)({},e,{colorAccessor:function(e){return Object(h.a)(e,a)?l(e[a]):l(e)},groupMetadata:i,groupKeys:u,groupLabels:d});default:throw new Error("Invalid action type in jobStateReducer")}};function _(e){var t=e.circleStrokeColor,o=e.circleStrokeWidth,a=e.className,c=e.colorPropName,i=void 0===c?"color":c,s=e.fontStrokeColor,u=e.fontStrokeWidth,f=e.groupPropName,g=void 0===f?"group_id":f,m=e.labelColorAccessor,h=e.labelPropName,v=void 0===h?"label":h,b=e.labelFont,y=void 0===b?"bold 1.1em Arial":b,A=e.labelFontSecondary,O=void 0===A?"0.9em Arial":A,N=e.margin,E=void 0===N?{top:60,right:20,bottom:10,left:20}:N,w=e.nodesMetadataPromise,S=e.pollingInterval,x=void 0===S?500:S,P=e.uniqueIdPropName,C=e.wrapperStyle,T=void 0===C?{height:"100%",width:"100%"}:C,I=Object(r.useReducer)(W,{colorAccessor:function(){return"#fff"},groupMetadata:{},groupKeys:[],groupLabels:[],nodes:[]}),k=Object(p.a)(I,2),_=k[0],M=k[1];return Object(r.useEffect)(function(){function e(){return(e=Object(l.a)(d.a.mark(function e(){var t,o,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:t=e.sent,o=t.groupMetadataArray,r=t.nodes,M({type:"SET_GROUP_METADATA",payload:{colorPropName:i,groupPropName:g,groupMetadataArray:o,labelPropName:v}}),M({type:"SET_NODES",payload:r});case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]),function(e,t){var o=Object(r.useRef)();Object(r.useEffect)(function(){o.current=e},[e]),Object(r.useEffect)(function(){if(null!==t){var e=setInterval(function(){o.current()},t);return function(){return clearInterval(e)}}},[t])}(function(){M({type:"SET_NODES",payload:R(_.nodes,_.groupKeys,g)})},x),n.a.createElement(j,{circleStrokeColor:t,circleStrokeWidth:o,className:a,colorAccessor:_.colorAccessor,fontStrokeColor:s,fontStrokeWidth:u,groupPropName:g,groupCounts:_.groupKeys.length,groupKeys:_.groupKeys,groupLabels:_.groupLabels,labelColorAccessor:m,labelFont:y,labelFontSecondary:O,nodes:_.nodes,margin:E,uniqueIdPropName:P,wrapperStyle:T})}var M=function(e){var t=e.match,o=t.params.nNodes?Number(t.params.nNodes):1e3,r=k.bind(null,{nNodes:o,groupPropName:"group_id"});return n.a.createElement("div",{className:"App"},n.a.createElement("h2",{className:"Job-status-title"},"Job Status Monitor for ",o," nodes"),n.a.createElement("div",{className:"Job-status-graph-container"},n.a.createElement(_,{colorPropName:"color",className:"Job-status-graph",groupPropName:"group_id",labelFont:"700 1.1rem Nunito",labelFontSecondary:"700 0.9rem Nunito",labelPropName:"label",margin:{top:60,right:20,bottom:20,left:20},nodesMetadataPromise:r,pollingInterval:1500,uniqueIdPropName:"demoDataGeneratorId",wrapperStyle:{height:"80%",width:"80%"}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(function(){return n.a.createElement(i.a,null,n.a.createElement(s.c,null,["/jobstatus/:nNodes","/jobstatus","/:nNodes",""].map(function(e,t){return n.a.createElement(s.a,{key:t,exact:!0,path:e,component:M})})))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[75,1,2]]]);
//# sourceMappingURL=main.0070b7a1.chunk.js.map