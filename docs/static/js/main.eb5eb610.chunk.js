(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{58:function(e,r,o){e.exports=o(75)},63:function(e,r,o){},64:function(e,r,o){},75:function(e,r,o){"use strict";o.r(r);var t=o(0),n=o.n(t),a=o(50),c=o.n(a),i=(o(63),o(64),o(54)),u=o(17),s=o(24),d=o.n(s),l=o(30),p=o(28),f=o(6),g=o(3),m=o(27),v=o(78);var h=o(51);var b=function(e){var r=e.drawFunction,o=void 0===r?function(){}:r,a=e.height,c=void 0===a?500:a,i=e.width,u=void 0===i?500:i,s=e.canvasPixelRatio,d=void 0===s?2:s,l=e.style,p=void 0===l?{}:l,f=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=Object(t.useRef)(null);return Object(t.useEffect)(function(){var t=o.current,n=t.getContext("2d"),a=requestAnimationFrame(function(){n.clearRect(0,0,t.width,t.height),n.save(),n.scale(r,r),e(n),n.restore()});return function(){return cancelAnimationFrame(a)}},[e]),o}(o,d),m={width:"".concat(u,"px"),height:"".concat(c,"px")};return n.a.createElement("canvas",{width:u*d,height:c*d,style:Object(g.a)({},m,p),ref:f})},y=function(e){var r=e.canvasPixelRatio,o=void 0===r?2:r,t=e.canvasStyle,a=void 0===t?{}:t,c=e.canvasDrawFunction,i=void 0===c?function(){}:c,u=e.height,s=e.width,d=e.wrapperClassName,l=void 0===d?"canvasWrapper":d,p=e.wrapperSizeRef,f=e.wrapperStyle,m=void 0===f?{}:f;return n.a.createElement("div",{className:l,ref:p,style:Object(g.a)({position:"absolute",width:"100%",height:"100%"},m)},n.a.createElement(b,{canvasPixelRatio:o,width:s,height:u,drawFunction:i,style:a}))},A=o(76),N=function(e){var r=e.bandPaddingInner,o=void 0===r?.5:r,t=e.bandPaddingOuter,n=void 0===t?.7:t,a=e.isHangingBar,c=void 0===a||a,i=e.groupIndexPropName,u=void 0===i?"groupIndex":i,s=e.groupPropName,d=e.groupKeys,l=e.height,p=e.margin,f=void 0===p?{top:10,right:10,bottom:10,left:10}:p,g=e.nodeCount,v=e.radiusToPaddingRatio,h=void 0===v?.9:v,b=e.width,y=Object(m.a)().domain(d).range([f.left,b-f.right]).paddingInner([o]).paddingOuter([n]),A=function(e){var r=e.bandwidth,o=e.height,t=e.margin,n=e.maxNodesPerBar,a=r*(o-t.top-t.bottom)/n;return.5*Math.sqrt(a)}({bandwidth:y.bandwidth(),height:l,maxNodesPerBar:g,margin:f,width:b}),N=A*h,S=2*A,O=y.step()*y.paddingOuter(),E=Math.ceil(y.bandwidth()/S),w=[l-f.bottom,f.top],P=Object(m.b)().domain([0,l]).range(c?w.reverse():w);return{radiusAccessor:function(){return N},xAccessor:function(e){var r=Math.floor(e[u]%E)*S+A-O;return y(e[s])+r},xScale:y,yAccessor:function(e){var r=Math.ceil((e[u]+1)/E);return P(r*S)}}},S=o(77);var O=function(e,r){switch(r.type){case"SET_LAYOUT":return Object(g.a)({},e,r.payload);case"START_RENDER":return Object(g.a)({},e,{isRendering:!0});case"FINISH_RENDER":return Object(g.a)({},e,{isRendering:!1});default:throw new Error("Invalid action type in progressReducer")}},E=function(e){var r=e.bandPaddingInner,o=void 0===r?.1:r,a=e.bandPaddingOuter,c=void 0===a?.1:a,i=e.className,u=e.circleStrokeColor,s=e.circleStrokeWidth,d=e.colorAccessor,l=e.fontStrokeColor,m=e.fontStrokeWidth,v=e.groupPropName,b=e.groupKeys,E=e.groupLabels,w=e.isHangingBar,P=void 0===w||w,x=e.labelColorAccessor,j=e.labelFont,I=void 0===j?"bold 1.1rem Arial":j,R=e.labelFontSecondary,k=void 0===R?"0.9rem Arial":R,C=e.nodes,T=e.margin,D=void 0===T?{top:60,right:20,bottom:10,left:20}:T,M=e.radiusToPaddingRatio,_=void 0===M?.8:M,F=e.uniqueIdPropName,W=e.wrapperStyle,K=Object(h.a)(),B=Object(p.a)(K,3),L=B[0],q=B[1],J=B[2],G=Object(t.useReducer)(O,{nodeCount:0,radiusAccessor:function(){return 1},xAccessor:function(){return 0},xScale:function(){return 0},yAccessor:function(){return 0},isRendering:!1}),U=Object(p.a)(G,2),H=U[0],z=U[1];Object(t.useEffect)(function(){var e=N({bandPaddingInner:o,bandPaddingOuter:c,isHangingBar:P,groupIndexPropName:Z,groupKeys:b,groupPropName:v,margin:D,nodeCount:C.length,width:q,height:J,radiusToPaddingRatio:_}),r=e.radiusAccessor,t=e.xAccessor,n=e.xScale,a=e.yAccessor;z({type:"SET_LAYOUT",payload:{nodeCount:C.length,radiusAccessor:r,xAccessor:t,xScale:n,yAccessor:a}})},[q,J,b,P,H.nodeCount]);var Q=function(e){var r=e.nodes,o=e.uniqueIdPropName,t=void 0===o?"uniqueId":o,n=e.groupPropName,a=e.groupIndexPropName,c=void 0===a?"groupIndex":a,i=e.groupKeys,u=Array.isArray(i)?i.reduce(function(e,r){return Object(g.a)({},e,Object(f.a)({},r,0))},{}):{};return{nodes:Object(A.a)(r,function(e,r,o){var a,i=r[n],s=r[t],d=void 0===s?o:s;u[i]||(u[i]=0);var l=u[i]++;return e[d]=Object(g.a)({},r,(a={},Object(f.a)(a,t,d),Object(f.a)(a,c,l),Object(f.a)(a,n,i),a)),e},{}),groupCounts:u,groupIndexPropName:c}}({groupPropName:v,groupKeys:b,nodes:C,uniqueIdPropName:F}),Y=Q.nodes,V=Q.groupCounts,Z=Q.groupIndexPropName,$=function(e){var r=e.nodes,o=e.colorAccessor,t=e.radiusAccessor,n=e.strokeColor,a=void 0===n?"#aaa":n,c=e.strokeWidth,i=void 0===c?"2":c,u=e.strokeLineJoin,s=void 0===u?"round":u,d=e.xAccessor,l=e.yAccessor;return function(e){Object(S.a)(r,function(r){var n=t(r),c=d(r),u=l(r),p=new Path2D(function(e,r,o){var t=e-o+","+r,n="A"+o+","+o+",0,1,1,";return"M"+t+n+(e+o)+","+r+n+t+"Z"}(c,u,n));e.strokeStyle=a,e.lineWidth=i,e.lineJoin=s,e.stroke(p),e.fillStyle=o(r),e.fill(p)})}}({nodes:Y,colorAccessor:d,radiusAccessor:H.radiusAccessor,strokeColor:u,strokeWidth:s,xAccessor:H.xAccessor,yAccessor:H.yAccessor}),X=function(e){var r=e.colorAccessor,o=e.font,t=void 0===o?"30px Arial":o,n=e.fontSecondary,a=void 0===n?"20px Arial":n,c=e.fontStrokeColor,i=void 0===c?"#aaa":c,u=e.fontStrokeWidth,s=void 0===u?.25:u,d=e.groupCounts,l=e.groupKeys,p=e.labels,f=e.xAccessor,g=e.yAccessor,m=e.numberOffset,v=void 0===m?20:m;return function(e){var o=[],n=0;d&&(o=Object.values(d),n=o.reduce(function(e,r){return e+r},0)),l.length===p.length&&l.forEach(function(c,u){var d=f(c),l=g(c),m=r(c);if(e.font=t,e.fillStyle=m,e.textAlign="center",e.textBaseline="middle",e.fillText(p[u],d,l),e.lineWidth=s,e.strokeStyle=i,e.strokeText(p[u],d,l),o.length===p.length){var h=o[u]/n*100,b=h<1?h.toPrecision(1):Math.round(h),y="".concat(b,"% (").concat(o[u],")");e.font=a,e.fillText(y,d,l+v),e.strokeText(y,d,l+v)}})}}({colorAccessor:x||d,font:I,fontSecondary:k,fontStrokeColor:l,fontStrokeWidth:m,groupCounts:V,groupKeys:b,labels:E,xAccessor:function(e){return H.xScale(e)-H.xScale.step()*H.xScale.paddingOuter()+H.xScale.bandwidth()/2},yAccessor:function(){return D.top/3},numberOffset:D.top/3+5});return n.a.createElement(y,{canvasDrawFunction:function(e){z({type:"START_RENDER"}),$(e),X(e),z({type:"FINISH_RENDER"})},canvasStyle:{background:"#fff"},width:q,height:J,wrapperClassName:i,wrapperSizeRef:L,wrapperStyle:W})},w=o(57),P=function(){var e=Object(l.a)(d.a.mark(function e(r){var o,t,n,a,c,i,u,s,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.metadataCsv,t=void 0===o?"group_id,label,sort_order,color\nD,DONE,7,#2ECC71\nE,RECOVERABLE,5,#F1948A\nF,FATAL,6,#E74C3C\nG,REGISTERED,1,#D6EAF8\nI,INSTANTIATED,3,#5DADE2\nQ,QUEUED,2,#3498DB\nR,RUNNING,4,#ebd857":o,n=r.nNodes,a=void 0===n?2e4:n,c=r.groupPropName,i=void 0===c?"group_id":c,e.next=3,Object(w.a)(t);case 3:return u=e.sent,s=Array.isArray(u)?u.sort(function(e,r){return e.sort_order-r.sort_order}):[],l=new Array(a).fill({}).map(function(e,r){return Object(f.a)({demoDataGeneratorId:"id_".concat(r)},i,s[0][i])}),e.abrupt("return",{nodes:l,groupMetadataArray:s});case 7:case"end":return e.stop()}},e)}));return function(r){return e.apply(this,arguments)}}(),x=function(e,r,o){var t=Math.floor(50*Math.random()),n=new Array(t).fill(0).map(function(){return Math.floor(Math.random()*e.length)});return e.map(function(e,t){if(n.includes(t)){var a=r.findIndex(function(r){return r===e[o]}),c=a;if("E"===r[a])c=1;else if("F"===r[a])c=a;else if("R"===r[a]){var i=Math.random()<=.05?a+2:a+1;c=Math.random()<=.1?i:r.length-1}else c=a<r.length-2?a+1:r.length-1;return Object(g.a)({},e,Object(f.a)({},o,r[c]))}return Object(g.a)({},e)})},j=function(e,r){switch(r.type){case"SET_NODES":return Object(g.a)({},e,{nodes:r.payload});case"SET_GROUP_METADATA":var o=r.payload,t=o.colorPropName,n=o.groupMetadataArray,a=o.groupPropName,c=o.labelPropName,i=n.reduce(function(e,r){return Object(g.a)({},e,Object(f.a)({},r[a],r))},{}),u=n.map(function(e){return e[t]}),s=n.map(function(e){return e[a]}),d=n.map(function(e){return e[c]}),l=Object(m.c)().domain(s).range(u);return Object(g.a)({},e,{colorAccessor:function(e){return Object(v.a)(e,a)?l(e[a]):l(e)},groupMetadata:i,groupKeys:s,groupLabels:d});default:throw new Error("Invalid action type in jobStateReducer")}},I=function(e){var r=e.circleStrokeColor,o=e.circleStrokeWidth,a=e.className,c=e.colorPropName,i=void 0===c?"color":c,u=e.fontStrokeColor,s=e.fontStrokeWidth,f=e.groupPropName,g=void 0===f?"group_id":f,m=e.labelColorAccessor,v=e.labelPropName,h=void 0===v?"label":v,b=e.labelFont,y=void 0===b?"bold 1.1em Arial":b,A=e.labelFontSecondary,N=void 0===A?"0.9em Arial":A,S=e.margin,O=void 0===S?{top:60,right:20,bottom:10,left:20}:S,w=e.nodesMetadataPromise,P=e.pollingInterval,I=void 0===P?500:P,R=(e.uniqueIdPropName,e.wrapperStyle),k=void 0===R?{height:"100%",width:"100%"}:R,C=Object(t.useReducer)(j,{colorAccessor:function(){return"#fff"},groupMetadata:{},groupKeys:[],groupLabels:[],nodes:[]}),T=Object(p.a)(C,2),D=T[0],M=T[1];return Object(t.useEffect)(function(){function e(){return(e=Object(l.a)(d.a.mark(function e(){var r,o,t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:r=e.sent,o=r.groupMetadataArray,t=r.nodes,M({type:"SET_GROUP_METADATA",payload:{colorPropName:i,groupPropName:g,groupMetadataArray:o,labelPropName:h}}),M({type:"SET_NODES",payload:t});case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]),function(e,r){var o=Object(t.useRef)();Object(t.useEffect)(function(){o.current=e},[e]),Object(t.useEffect)(function(){if(null!==r){var e=setInterval(function(){o.current()},r);return function(){return clearInterval(e)}}},[r])}(function(){M({type:"SET_NODES",payload:x(D.nodes,D.groupKeys,g)})},I),n.a.createElement(E,{circleStrokeColor:r,circleStrokeWidth:o,className:a,colorAccessor:D.colorAccessor,fontStrokeColor:u,fontStrokeWidth:s,groupPropName:g,groupCounts:D.groupKeys.length,groupKeys:D.groupKeys,groupLabels:D.groupLabels,labelColorAccessor:m,labelFont:y,labelFontSecondary:N,nodes:D.nodes,margin:O,uniqueIdPropName:!0,wrapperStyle:k})},R=function(e){var r=e.match,o=r.params.nNodes?Number(r.params.nNodes):1e3,t=P.bind(null,{nNodes:o,groupPropName:"group_id"});return n.a.createElement("div",{className:"App"},n.a.createElement("h2",{className:"Job-status-title"},"Job Status Monitor for ",o," nodes"),n.a.createElement("div",{className:"Job-status-graph-container"},n.a.createElement(I,{colorPropName:"color",className:"Job-status-graph",groupPropName:"group_id",labelFont:"700 1.1rem Nunito",labelFontSecondary:"700 0.9rem Nunito",labelPropName:"label",margin:{top:60,right:20,bottom:20,left:20},nodesMetadataPromise:t,pollingInterval:500,uniqueIdPropName:"demoDataGeneratorId",wrapperStyle:{height:"80%",width:"80%"}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(function(){return n.a.createElement(i.a,null,n.a.createElement(u.c,null,["/jobstatus/:nNodes","/jobstatus","/:nNodes",""].map(function(e,r){return n.a.createElement(u.a,{key:r,exact:!0,path:e,component:R})})))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[58,1,2]]]);
//# sourceMappingURL=main.eb5eb610.chunk.js.map