(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{75:function(e,t,o){e.exports=o(92)},80:function(e,t,o){},81:function(e,t,o){},92:function(e,t,o){"use strict";o.r(t);var n=o(0),r=o.n(n),a=o(66),c=o.n(a),i=(o(80),o(81),o(71)),s=o(25),u=o(40),d=o.n(u),l=o(47),p=o(45),f=o(9),v=o(2),g=o(44),m=o(97);var h=o(93),b=o(94),y=o(96),A=o(67);function O(e){var t=e.click,o=e.drawFunction,a=void 0===o?function(){}:o,c=e.height,i=void 0===c?500:c,s=e.width,u=void 0===s?500:s,d=e.canvasPixelRatio,l=void 0===d?2:d,p=e.mousedown,f=e.mousemove,g=e.mouseup,m=e.style,h=void 0===m?{}:m,b=e.touchend,y=e.touchmove,A=e.touchstart,O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=Object(n.useRef)(null);return Object(n.useEffect)(function(){var n=o.current,r=n.getContext("2d"),a=requestAnimationFrame(function(){r.clearRect(0,0,n.width,n.height),r.save(),r.scale(t,t),e(r),r.restore()});return function(){return cancelAnimationFrame(a)}},[e]),o}(a,l),N={width:"".concat(u,"px"),height:"".concat(i,"px")};return r.a.createElement("canvas",{width:u*l,height:i*l,style:Object(v.a)({},N,h),ref:O,onTouchStart:A,onTouchMove:y,onTouchEnd:b,onMouseMove:f,onMouseDown:p,onMouseUp:g,onClick:t})}function N(e){var t=e.click,o=e.canvasPixelRatio,n=void 0===o?2:o,a=e.canvasStyle,c=void 0===a?{}:a,i=e.canvasDrawFunction,s=void 0===i?function(){}:i,u=e.eventCanvasDrawFunction,d=e.eventCanvasStyle,l=void 0===d?{position:"absolute",top:0,left:0,opacity:0}:d,p=e.height,f=e.mousemove,g=e.mousedown,m=e.mouseup,h=e.touchend,b=e.touchmove,y=e.touchstart,A=e.width,N=e.wrapperClassName,E=void 0===N?"canvasWrapper":N,S=e.wrapperSizeRef,w=e.wrapperStyle,x=void 0===w?{}:w,P=u?r.a.createElement(O,{canvasPixelRatio:n,width:A,height:p,drawFunction:u,style:Object(v.a)({},c,l),touchstart:y,touchmove:b,touchend:h,mousemove:f,mousedown:g,mouseup:m,click:t}):"",C=u?{pointerEvents:"none"}:{};return r.a.createElement("div",{className:E,ref:S,style:Object(v.a)({position:"absolute",width:"100%",height:"100%"},x)},P,r.a.createElement(O,{canvasPixelRatio:n,width:A,height:p,drawFunction:s,style:Object(v.a)({},c,C)}))}function E(e){var t=e.borderWidth,o=e.opacity,n=e.content,a=e.contentWidth,c=e.left,i=e.font,s=e.padding,u=e.top;return r.a.createElement("div",{className:"tooltipWrapper",style:{position:"absolute",opacity:o,top:"".concat(u,"px"),left:"".concat(c,"px")}},r.a.createElement("span",{className:"tooltipArrow",style:{content:"",position:"absolute",bottom:"100%",left:"50%",borderWidth:"-".concat(t,"px"),borderStyle:"solid",borderColor:"transparent transparent #999 transparent"}}),r.a.createElement("span",{className:"tooltipContent",style:{position:"absolute",padding:"".concat(s,"px"),width:"".concat(a,"px"),top:"100%",left:"50%",marginLeft:"-".concat(a/2,"px"),font:i,color:"#000",backgroundColor:"#fff",border:"2px solid #999",borderRadius:"5px",pointerEvents:"none",opacity:1,zIndex:1}},n))}var S=function(e){var t=e.nodes,o=e.uniqueIdPropName,n=void 0===o?"uniqueId":o,r=e.groupPropName,a=e.groupIndexPropName,c=void 0===a?"groupIndex":a,i=e.groupKeys,s=Array.isArray(i)?i.reduce(function(e,t){return Object(v.a)({},e,Object(f.a)({},t,0))},{}):{},u={},d={},l=Object(b.a)(t,function(e,t,o){var a,i=t[r],l=t[n],p=void 0===l?o:l;s[i]||(s[i]=0);var g=s[i]++,m=function(e){return e<16777215?"rgb(".concat(255&e,",").concat((65280&e)>>8,",").concat((16711680&e)>>16,")"):""}(o+1);return u[m]=t,d[p]=m,e[p]=Object(v.a)({},t,(a={},Object(f.a)(a,n,p),Object(f.a)(a,c,g),Object(f.a)(a,r,i),a)),e},{});return{colorToNode:u,nodes:l,groupCounts:s,groupIndexPropName:c,nodeIdToColor:d}},w=function(e){var t=e.bandPaddingInner,o=void 0===t?.5:t,n=e.bandPaddingOuter,r=void 0===n?.7:n,a=e.isHangingBar,c=void 0===a||a,i=e.groupIndexPropName,s=void 0===i?"groupIndex":i,u=e.groupPropName,d=e.groupKeys,l=e.height,p=e.margin,f=void 0===p?{top:10,right:10,bottom:10,left:10}:p,v=e.nodeCount,m=e.radiusToPaddingRatio,h=void 0===m?.9:m,b=e.width,y=Object(g.a)().domain(d).range([f.left,b-f.right]).paddingInner([o]).paddingOuter([r]),A=function(e){var t=e.bandwidth,o=e.height,n=e.margin,r=e.maxNodesPerBar,a=t*(o-n.top-n.bottom)/r;return.5*Math.sqrt(a)}({bandwidth:y.bandwidth(),height:l,maxNodesPerBar:v,margin:f,width:b}),O=A*h,N=2*A,E=y.step()*y.paddingOuter(),S=Math.ceil(y.bandwidth()/N),w=[l-f.bottom,f.top],x=Object(g.b)().domain([0,l]).range(c?w.reverse():w);return{radiusWithPadding:A,radiusAccessor:function(){return O},xAccessor:function(e){var t=Math.floor(e[s]%S)*N+A-E;return y(e[u])+t},xScale:y,yAccessor:function(e){var t=Math.ceil((e[s]+1)/S);return x(t*N)}}},x=o(95);var P=function(e){var t=e.nodes,o=e.colorAccessor,n=e.radiusAccessor,r=e.strokeColorAccessor,a=void 0===r?function(){return"#aaa"}:r,c=e.strokeWidth,i=void 0===c?"2":c,s=e.strokeLineJoin,u=void 0===s?"round":s,d=e.xAccessor,l=e.yAccessor;return function(e){Object(x.a)(t,function(t){var r=new Path2D(function(e,t,o){var n=e-o+","+t,r="A"+o+","+o+",0,1,1,";return"M"+n+r+(e+o)+","+t+r+n+"Z"}(d(t),l(t),n(t)));i>0&&(e.strokeStyle=a(t),e.lineWidth=i,e.lineJoin=u,e.stroke(r)),e.fillStyle=o(t),e.fill(r)})}},C=function(e){var t=e.colorAccessor,o=e.font,n=void 0===o?"30px Arial":o,r=e.fontSecondary,a=void 0===r?"20px Arial":r,c=e.fontStrokeColor,i=void 0===c?"#aaa":c,s=e.fontStrokeWidth,u=void 0===s?.25:s,d=e.groupCounts,l=e.groupKeys,p=e.labels,f=e.xAccessor,v=e.yAccessor,g=e.numberOffset,m=void 0===g?20:g;return function(e){var o=[],r=0;d&&(o=Object.values(d),r=o.reduce(function(e,t){return e+t},0)),l.length===p.length&&l.forEach(function(c,s){var d=f(c),l=v(c),g=t(c);if(e.font=n,e.fillStyle=g,e.textAlign="center",e.textBaseline="middle",e.fillText(p[s],d,l),e.lineWidth=u,e.strokeStyle=i,e.strokeText(p[s],d,l),o.length===p.length){var h=o[s]/r*100,b=h<1?h.toPrecision(1):Math.round(h),y="".concat(b,"% (").concat(o[s],")");e.font=a,e.fillText(y,d,l+m),e.strokeText(y,d,l+m)}})}},T=function(e,t){switch(t.type){case"SET_TOOLTIP_CONTENT":case"SET_LAYOUT":return Object(v.a)({},e,t.payload);case"START_RENDER":return Object(v.a)({},e,{isRendering:!0});case"FINISH_RENDER":return Object(v.a)({},e,{isRendering:!1});default:throw new Error("Invalid action type in progressReducer")}};function j(e){var t=e.bandPaddingInner,o=void 0===t?.1:t,a=e.bandPaddingOuter,c=void 0===a?.1:a,i=e.className,s=e.circleStrokeColor,u=void 0===s?"#aaa":s,d=e.circleStrokeWidth,l=e.colorAccessor,f=e.canvasStyle,v=void 0===f?{background:"transparent"}:f,g=e.eventCanvasStyle,m=e.fontStrokeColor,O=e.fontStrokeWidth,x=e.groupPropName,j=e.groupKeys,I=e.groupLabels,k=e.isHangingBar,R=void 0===k||k,W=e.labelColorAccessor,_=e.labelFont,M=void 0===_?"bold 1.1rem Arial":_,D=e.labelFontSecondary,F=void 0===D?"0.9rem Arial":D,L=e.nodes,K=e.margin,q=void 0===K?{top:60,right:20,bottom:10,left:20}:K,B=e.radiusToPaddingRatio,J=void 0===B?.8:B,U=e.uniqueIdPropName,G=e.wrapperStyle,H=Object(A.a)(),Y=Object(p.a)(H,3),z=Y[0],Q=Y[1],X=Y[2],V=Object(n.useReducer)(T,{isRendering:!1,nodeCount:0,tooltipContent:"",tooltipContentWidth:0,tooltipOffset:[0,0],radiusWithPadding:1,radiusAccessor:function(){return 1},xAccessor:function(){return 0},xScale:function(){return 0},yAccessor:function(){return 0}}),Z=Object(p.a)(V,2),$=Z[0],ee=Z[1];Object(n.useEffect)(function(){var e=w({bandPaddingInner:o,bandPaddingOuter:c,isHangingBar:R,groupIndexPropName:ae,groupKeys:j,groupPropName:x,margin:q,nodeCount:L.length,width:Q,height:X,radiusToPaddingRatio:J}),t=e.radiusWithPadding,n=e.radiusAccessor,r=e.xAccessor,a=e.xScale,i=e.yAccessor;ee({type:"SET_LAYOUT",payload:{nodeCount:L.length,radiusWithPadding:t,radiusAccessor:n,xAccessor:r,xScale:a,yAccessor:i}})},[Q,X,j,R,$.nodeCount]);var te=S({groupPropName:x,groupKeys:j,nodes:L,uniqueIdPropName:U}),oe=te.colorToNode,ne=te.nodes,re=te.groupCounts,ae=te.groupIndexPropName,ce=te.nodeIdToColor,ie=P({nodes:ne,colorAccessor:function(e){return ce[e[U]]||""},radiusAccessor:function(){return $.radiusWithPadding},strokeColorAccessor:function(e){return ce[e[U]]||""},strokeWidth:0,xAccessor:$.xAccessor,yAccessor:$.yAccessor}),se=P({nodes:ne,colorAccessor:l,radiusAccessor:$.radiusAccessor,strokeColorAccessor:function(){return u},strokeWidth:d,xAccessor:$.xAccessor,yAccessor:$.yAccessor}),ue=C({colorAccessor:W||l,font:M,fontSecondary:F,fontStrokeColor:m,fontStrokeWidth:O,groupCounts:re,groupKeys:j,labels:I,xAccessor:function(e){return $.xScale(e)-$.xScale.step()*$.xScale.paddingOuter()+$.xScale.bandwidth()/2},yAccessor:function(){return q.top/3},numberOffset:q.top/3+5});return r.a.createElement(r.a.Fragment,null,r.a.createElement(N,{canvasPixelRatio:2,canvasDrawFunction:function(e){ee({type:"START_RENDER"}),se(e),ue(e),ee({type:"FINISH_RENDER"})},canvasStyle:v,eventCanvasStyle:g,eventCanvasDrawFunction:ie,height:X,mousemove:function(e){var t=e,o=t.target.getContext("2d"),n=o.getImageData(2*t.nativeEvent.offsetX,2*t.nativeEvent.offsetY,1,1).data,a=oe["rgb(".concat(n[0],",").concat(n[1],",").concat(n[2],")")];if(a){var c=Object(h.a)(a,[ae]),i=Object(b.a)(c,function(e,t,n){o.font=F;var r=o.measureText("".concat(t,": ").concat(n)).width;return r>e?r+6:e},0);ee({type:"SET_TOOLTIP_CONTENT",payload:{tooltipContent:Object(y.a)(c,function(e,t){return r.a.createElement("p",{style:{margin:"2px",textAlign:"center"},key:t},t,": ",e)}),tooltipContentWidth:i,tooltipOffset:[t.pageX,t.pageY]}})}else ee({type:"SET_TOOLTIP_CONTENT",payload:{tooltipContent:"",tooltipContentWidth:0,tooltipOffset:$.tooltipContent}})},width:Q,wrapperClassName:i,wrapperSizeRef:z,wrapperStyle:G}),r.a.createElement(E,{borderWidth:$.radiusWithPadding,content:$.tooltipContent,opacity:""===$.tooltipContent?0:.85,contentWidth:$.tooltipContentWidth,left:$.tooltipOffset[0],font:F,padding:3,top:$.tooltipOffset[1]}))}var I=o(74),k=function(){var e=Object(l.a)(d.a.mark(function e(t){var o,n,r,a,c,i,s,u,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.metadataCsv,n=void 0===o?"group_id,label,sort_order,color\nD,DONE,7,#2ECC71\nE,RECOVERABLE,5,#F1948A\nF,FATAL,6,#E74C3C\nG,REGISTERED,1,#D6EAF8\nI,INSTANTIATED,3,#5DADE2\nQ,QUEUED,2,#3498DB\nR,RUNNING,4,#ebd857":o,r=t.nNodes,a=void 0===r?2e4:r,c=t.groupPropName,i=void 0===c?"group_id":c,e.next=3,Object(I.a)(n);case 3:return s=e.sent,u=Array.isArray(s)?s.sort(function(e,t){return e.sort_order-t.sort_order}):[],l=new Array(a).fill({}).map(function(e,t){var o;return o={unique_id:"id_".concat(t+1)},Object(f.a)(o,i,u[0][i]),Object(f.a)(o,"some_other_prop","with a very long name"),o}),e.abrupt("return",{nodes:l,groupMetadataArray:u});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),R=function(e,t,o){var n=Math.floor(50*Math.random()),r=new Array(n).fill(0).map(function(){return Math.floor(Math.random()*e.length)});return e.map(function(e,n){if(r.includes(n)){var a=t.findIndex(function(t){return t===e[o]}),c=a;if("E"===t[a])c=1;else if("F"===t[a])c=a;else if("R"===t[a]){var i=Math.random()<=.05?a+2:a+1;c=Math.random()<=.1?i:t.length-1}else c=a<t.length-2?a+1:t.length-1;return Object(v.a)({},e,Object(f.a)({},o,t[c]))}return Object(v.a)({},e)})},W=function(e,t){switch(t.type){case"SET_NODES":return Object(v.a)({},e,{nodes:t.payload});case"SET_GROUP_METADATA":var o=t.payload,n=o.colorPropName,r=o.groupMetadataArray,a=o.groupPropName,c=o.labelPropName,i=r.reduce(function(e,t){return Object(v.a)({},e,Object(f.a)({},t[a],t))},{}),s=r.map(function(e){return e[n]}),u=r.map(function(e){return e[a]}),d=r.map(function(e){return e[c]}),l=Object(g.c)().domain(u).range(s);return Object(v.a)({},e,{colorAccessor:function(e){return Object(m.a)(e,a)?l(e[a]):l(e)},groupMetadata:i,groupKeys:u,groupLabels:d});default:throw new Error("Invalid action type in jobStateReducer")}};function _(e){var t=e.canvasStyle,o=e.circleStrokeColor,a=e.circleStrokeWidth,c=e.className,i=e.colorPropName,s=void 0===i?"color":i,u=e.eventCanvasStyle,f=e.fontStrokeColor,v=e.fontStrokeWidth,g=e.groupPropName,m=void 0===g?"group_id":g,h=e.labelColorAccessor,b=e.labelPropName,y=void 0===b?"label":b,A=e.labelFont,O=void 0===A?"bold 1.1em Arial":A,N=e.labelFontSecondary,E=void 0===N?"0.9em Arial":N,S=e.margin,w=void 0===S?{top:60,right:20,bottom:10,left:20}:S,x=e.nodesMetadataPromise,P=e.pollingInterval,C=void 0===P?500:P,T=e.uniqueIdPropName,I=e.wrapperStyle,k=void 0===I?{height:"100%",width:"100%"}:I,_=Object(n.useReducer)(W,{colorAccessor:function(){return"#fff"},groupMetadata:{},groupKeys:[],groupLabels:[],nodes:[]}),M=Object(p.a)(_,2),D=M[0],F=M[1];return Object(n.useEffect)(function(){function e(){return(e=Object(l.a)(d.a.mark(function e(){var t,o,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:t=e.sent,o=t.groupMetadataArray,n=t.nodes,F({type:"SET_GROUP_METADATA",payload:{colorPropName:s,groupPropName:m,groupMetadataArray:o,labelPropName:y}}),F({type:"SET_NODES",payload:n});case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]),function(e,t){var o=Object(n.useRef)();Object(n.useEffect)(function(){o.current=e},[e]),Object(n.useEffect)(function(){if(null!==t){var e=setInterval(function(){o.current()},t);return function(){return clearInterval(e)}}},[t])}(function(){F({type:"SET_NODES",payload:R(D.nodes,D.groupKeys,m)})},C),r.a.createElement(j,{canvasStyle:t,circleStrokeColor:o,circleStrokeWidth:a,className:c,colorAccessor:D.colorAccessor,eventCanvasStyle:u,fontStrokeColor:f,fontStrokeWidth:v,groupPropName:m,groupCounts:D.groupKeys.length,groupKeys:D.groupKeys,groupLabels:D.groupLabels,labelColorAccessor:h,labelFont:O,labelFontSecondary:E,nodes:D.nodes,margin:w,uniqueIdPropName:T,wrapperStyle:k})}var M=function(e){var t=e.match,o=t.params.nNodes?Number(t.params.nNodes):1e3,n=k.bind(null,{nNodes:o,groupPropName:"group_id"});return r.a.createElement("div",{className:"App"},r.a.createElement("h2",{className:"Job-status-title"},"Job Status Monitor for ",o," nodes"),r.a.createElement("div",{className:"Job-status-graph-container"},r.a.createElement(_,{colorPropName:"color",className:"Job-status-graph",groupPropName:"group_id",labelFont:"700 1.1rem Nunito",labelFontSecondary:"700 0.9rem Nunito",labelPropName:"label",margin:{top:60,right:20,bottom:20,left:20},nodesMetadataPromise:n,pollingInterval:1500,uniqueIdPropName:"demoDataGeneratorId",wrapperStyle:{height:"80%",width:"80%"}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(function(){return r.a.createElement(i.a,null,r.a.createElement(s.c,null,["/jobstatus/:nNodes","/jobstatus","/:nNodes",""].map(function(e,t){return r.a.createElement(s.a,{key:t,exact:!0,path:e,component:M})})))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[75,1,2]]]);
//# sourceMappingURL=main.c20e3930.chunk.js.map